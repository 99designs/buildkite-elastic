FROM alpine:latest

RUN apk add --update \
    ca-certificates \
    python \
    python-dev \
    py-pip \
    build-base \
    && pip install awscli --upgrade --user \
    && apk --purge -v del py-pip \
    && rm -rf /var/cache/apk/*
    
RUN wget https://github.com/optiopay/klar/releases/download/v2.4.0/klar-2.4.0-linux-amd64 -O /bin/klar \
    && chmod +x /bin/klar

COPY ./scan-images.sh /scan-images

ENTRYPOINT [ "/scan-images" ]